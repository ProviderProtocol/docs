---
title: Image
description: Image utility class for handling image content.
---

import { Aside, Badge, Tabs, TabItem } from '@astrojs/starlight/components';

# Image

<Badge text="UPP-1.1 Compliant" variant="success" />

Utility class for handling image content in messages. Provides factory methods for creating images from various sources and conversion methods for different formats.

<Aside type="note" title="Specification">
  Implements the [UPP-1.1 Image Content](/spec/llm/messages) handling.
</Aside>

## Import

```typescript
import { Image } from '@providerprotocol/ai';
```

## Class Definition

```typescript
class Image {
  readonly source: ImageSource;
  readonly mimeType: string;
  readonly width?: number;
  readonly height?: number;

  /** Check if this image has data loaded (false for URL sources) */
  readonly hasData: boolean;

  // Conversion methods
  toBase64(): string;
  toDataUrl(): string;
  toBytes(): Uint8Array;
  toUrl(): string;
  toBlock(): ImageBlock;

  // Factory methods (static)
  static fromPath(path: string): Promise<Image>;
  static fromUrl(url: string, mimeType?: string): Image;
  static fromBytes(data: Uint8Array, mimeType: string): Image;
  static fromBase64(data: string, mimeType: string): Image;
  static fromBlock(block: ImageBlock): Image;
}
```

## ImageSource Types

```typescript
type ImageSource =
  | { type: 'base64'; data: string }
  | { type: 'url'; url: string }
  | { type: 'bytes'; data: Uint8Array };
```

## Factory Methods

<Tabs>
  <TabItem label="From File">
```typescript
// Load image from file path
const image = await Image.fromPath('./diagram.png');

// Automatically detects MIME type from extension
console.log(image.mimeType); // 'image/png'
```
  </TabItem>
  <TabItem label="From URL">
```typescript
// Reference image by URL (does not fetch)
const image = Image.fromUrl('https://example.com/image.png');

// Optionally specify MIME type
const jpeg = Image.fromUrl('https://example.com/photo', 'image/jpeg');
```
  </TabItem>
  <TabItem label="From Bytes">
```typescript
// Create from raw bytes
const bytes = await Bun.file('image.png').bytes();
const image = Image.fromBytes(bytes, 'image/png');
```
  </TabItem>
  <TabItem label="From Base64">
```typescript
// Create from base64 string
const base64 = '...'; // base64 encoded image data
const image = Image.fromBase64(base64, 'image/png');
```
  </TabItem>
</Tabs>

## Using in Messages

```typescript
import { llm, Image } from '@providerprotocol/ai';
import { anthropic } from '@providerprotocol/ai/anthropic';

const claude = llm({
  model: anthropic('claude-sonnet-4-20250514'),
});

// Send image in message
const turn = await claude.generate(
  'Describe this image:',
  await Image.fromPath('screenshot.png')
);

// Or with URL
const turn2 = await claude.generate(
  'What is in this photo?',
  Image.fromUrl('https://example.com/photo.jpg')
);
```

## Conversion Methods

```typescript
const image = await Image.fromPath('diagram.png');

// To base64 string (for embedding)
const base64 = image.toBase64();

// To data URL (for HTML img src)
const dataUrl = image.toDataUrl();
// "data:image/png;base64,..."

// To raw bytes (for saving)
const bytes = image.toBytes();
await Bun.write('copy.png', bytes);

// To ContentBlock (for manual message construction)
const block = image.toBlock();
```

## Error Handling

<Aside type="caution">
Conversion methods throw if the source type is incompatible:

- `toBase64()`, `toBytes()` throw for URL sources
- `toUrl()` throws for non-URL sources
</Aside>

```typescript
const urlImage = Image.fromUrl('https://example.com/img.png');

// This works
console.log(urlImage.toUrl());

// This throws - can't get bytes from URL reference
try {
  urlImage.toBytes();
} catch (e) {
  console.error('Cannot convert URL image to bytes');
}
```

## Related

- [Messages Specification](/spec/llm/messages)
- [Content Types](/api/types/content)
